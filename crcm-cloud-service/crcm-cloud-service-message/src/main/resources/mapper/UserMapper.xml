<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.SysOrg//DTD Mapper 3.0//EN" "http://mybatis.SysOrg/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.crcm.admin.mapper.UserMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.crcm.admin.model.entity.SysUser">
        <id column="id" property="id"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="user_name" property="username"/>
        <result column="password" property="password"/>
        <result column="avatar" property="avatar"/>
        <result column="locked" property="locked"/>
        <result column="comment" property="comment"/>
        <result column="phone" property="phone"/>
        <result column="email" property="email"/>
        <result column="deleted" property="deleted"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        create_by,
        create_time,
        update_by,
        update_time,
        version,
        id, account, password, user_status, head_portrait, login_count, app_login_count, login_ip,
        lassys_login, cid, locked, comment, phone, email, deleted
    </sql>

    <select id="findPageUser" resultType="com.crcm.admin.model.vo.UserVO">
        select u.*,ud.name person_name,o.name org_name from sys_user u
        LEFT JOIN sys_user_detail ud on ud.user_id = u.id
        LEFT JOIN sys_org o on o.id = u.org_id
        where u.deleted = 0
        <if test="user.username != '' and user.username != null">
            and ( u.username like CONCAT(CONCAT('%',#{user.username},'%')) or ud.name like CONCAT(CONCAT('%',#{user.username},'%')) )
        </if>
        <if test="user.locked != '' and user.locked != null">
            and u.locked = #{user.locked}
        </if>
    </select>

    <select id="findTree" resultType="com.crcm.core.dto.TreeView">
        select id,username as label,org_id as pid from sys_user where deleted = 0
    </select>

    <select id="findAll" resultType="map">
        select * from sys_user where deleted='0'
    </select>

    <select id="selectUserBaseInfo" resultType="com.crcm.admin.model.vo.UserBaseInfoVO">
        select id,username,avatar,comment,email,phone,nick_name from sys_user where id= #{id} and deleted='0'
    </select>


</mapper>
