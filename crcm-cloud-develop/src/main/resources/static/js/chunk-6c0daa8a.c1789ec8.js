(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c0daa8a"],{"4b72":function(e,t,a){"use strict";a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"g",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a("b775");function l(e){return Object(n["a"])({url:"/tool/gen/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/tool/gen/db/list",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/tool/gen/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/tool/gen",method:"put",data:e})}function s(e){return Object(n["a"])({url:"/tool/gen/importTable",method:"post",params:e})}function c(e){return Object(n["a"])({url:"/tool/gen/preview/"+e,method:"get"})}function u(e){return Object(n["a"])({url:"/tool/gen/"+e,method:"delete"})}},5697:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return c}));var n=a("b775");function l(e){return Object(n["a"])({url:"/datasourceconf/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/datasourceconf/page",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/datasourceconf/save",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/datasourceconf/update",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/datasourceconf/delete/"+e.id,method:"post"})}function c(e){return Object(n["a"])({url:"/datasourceconf/check/"+e.id,method:"get"})}},"6bb1":function(e,t,a){},b157:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("aside",[e._v("数据库")]),a("datasourceList",{attrs:{data:e.treeData},on:{nodeSelect:e.handleSelect}})],1),a("el-col",{attrs:{span:20}},[a("aside",[e._v("表数据")]),a("dataTable",{ref:"dataTable"})],1)],1)],1)],1)},l=[],i=(a("159b"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-list"},[e.showFilter?a("el-input",{staticClass:"el-list-filter",attrs:{placeholder:"请输入过滤内容",clearable:""},model:{value:e.filteText,callback:function(t){e.filteText=t},expression:"filteText"}}):e._e(),a("el-table",{ref:"dataList",attrs:{data:e.tableData,border:"","show-header":e.showHeader},on:{"row-click":e.clickRow,select:e.dialogCheck}},[e.showSelection?a("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}):e._e(),a("el-table-column",{attrs:{prop:"label",align:"center"}})],1)],1)}),r=[],o=(a("4de4"),a("b64b"),{props:{data:{type:Array},showHeader:{type:Boolean,default:!1},showFilter:{type:Boolean,default:!0},showSelection:{type:Boolean,default:!0},singleSelect:{type:Boolean,default:!0}},data:function(){return{filteText:void 0,defaultProps:{children:"children",label:"label"},checked:void 0,selectioned:void 0}},computed:{tableData:function(){var e=this.filteText;return e?this.data.filter((function(t){return Object.keys(t).some((function(a){return String(t[a]).toLowerCase().indexOf(e)>-1}))})):this.data}},created:function(){},methods:{clickRow:function(e){this.dialogCheck([e],e)},dialogCheck:function(e,t){this.$refs.dataList.clearSelection(),0!==e.length?t&&(this.selectioned=t,this.$refs.dataList.toggleRowSelection(t,!0),this.$emit("nodeSelect",t)):this.$emit("nodeSelect",[])},handleNodeClick:function(e,t,a){this.$emit("nodeSelect",e.key)}}}),s=o,c=(a("c4fc"),a("2877")),u=Object(c["a"])(s,i,r,!1,null,null,null),d=u.exports,m=a("5697"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"表名称",prop:"tableName"}},[a("el-input",{attrs:{placeholder:"请输入表名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.tableName,callback:function(t){e.$set(e.queryParams,"tableName",t)},expression:"queryParams.tableName"}})],1),a("el-form-item",{attrs:{label:"表描述",prop:"tableComment"}},[a("el-input",{attrs:{placeholder:"请输入表描述",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.tableComment,callback:function(t){e.$set(e.queryParams,"tableComment",t)},expression:"queryParams.tableComment"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v(" 重置 ")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.handleGenTable}},[e._v(" 生成 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"info",icon:"el-icon-upload",size:"mini"},on:{click:e.openImportTable}},[e._v(" 导入 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"success",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleEditTable}},[e._v(" 修改 ")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v(" 删除 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s((e.queryParams.current-1)*e.queryParams.size+t.$index+1))])]}}])}),a("el-table-column",{attrs:{label:"数据源",align:"center",prop:"datasourceName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0,width:"130"}}),a("el-table-column",{attrs:{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"100"}}),a("el-table-column",{attrs:{label:"更新时间",align:"center",prop:"updateTime",width:"100"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-view"},on:{click:function(a){return e.handlePreview(t.row)}}},[e._v(" 预览 ")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.handleEditTable(t.row)}}},[e._v(" 编辑 ")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v(" 删除 ")]),a("el-button",{attrs:{type:"text",s:"",size:"small",icon:"el-icon-download"},on:{click:function(a){return e.handleGenTable(t.row)}}},[e._v(" 生成代码 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.current,limit:e.queryParams.size},on:{"update:page":function(t){return e.$set(e.queryParams,"current",t)},"update:limit":function(t){return e.$set(e.queryParams,"size",t)},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.preview.title,visible:e.preview.open,width:"80%",top:"5vh","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.preview,"open",t)}}},[a("el-tabs",{model:{value:e.preview.activeName,callback:function(t){e.$set(e.preview,"activeName",t)},expression:"preview.activeName"}},e._l(e.preview.data,(function(t,n){return a("el-tab-pane",{key:n,attrs:{label:n.substring(n.lastIndexOf("/")+1,n.indexOf(".vm")),name:n.substring(n.lastIndexOf("/")+1,n.indexOf(".vm"))}},[a("pre",[e._v(e._s(t))])])})),1)],1),a("import-table",{ref:"import",on:{ok:e.handleQuery}})],1)},p=[],h=(a("d81d"),a("4b72")),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"导入表",visible:e.visible,width:"800px",top:"5vh","append-to-body":""},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"数据源",prop:"datasourceId"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择数据源"},on:{change:e.hendleChangeDataSource},model:{value:e.datasourceId,callback:function(t){e.datasourceId=t},expression:"datasourceId"}},e._l(e.datasources,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"表名称",prop:"tableName"}},[a("el-input",{attrs:{placeholder:"请输入表名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.tableName,callback:function(t){e.$set(e.queryParams,"tableName",t)},expression:"queryParams.tableName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v(" 重置 ")])],1)],1),a("el-row",[a("el-table",{ref:"table",attrs:{data:e.dbTableList,height:"260px"},on:{"row-click":e.clickRow,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"tableName",label:"表名称"}}),a("el-table-column",{attrs:{prop:"tableComment",label:"表描述"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.current,limit:e.queryParams.size},on:{"update:page":function(t){return e.$set(e.queryParams,"current",t)},"update:limit":function(t){return e.$set(e.queryParams,"size",t)},pagination:e.getList}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleImportTable}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")])],1)],1)},v=[],y=(a("a15b"),{data:function(){return{visible:!1,datasourceId:void 0,tables:[],total:0,dbTableList:[],datasources:[],queryParams:{current:1,size:100,tableName:void 0,tableComment:void 0,datasourceId:void 0}}},methods:{init:function(){this.getList(),this.getDatasources(),this.visible=!0},clickRow:function(e){this.$refs.table.toggleRowSelection(e)},handleSelectionChange:function(e){this.tables=e.map((function(e){return e.tableName}))},getList:function(){var e=this;Object(h["d"])(this.queryParams).then((function(t){200===t.code&&(e.dbTableList=t.data,e.total=t.data.length)}))},getDatasources:function(){var e=this;Object(m["c"])().then((function(t){t.success&&(e.datasources=t.data)}))},handleQuery:function(){this.queryParams.current=1,this.getList()},hendleChangeDataSource:function(e){this.queryParams.datasourceId=e,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleImportTable:function(){var e=this,t={tables:this.tables.join(","),datasourceId:this.datasourceId};console.log(t),Object(h["c"])(t).then((function(t){200===t.code&&(e.msgSuccess("导入成功！"),e.visible=!1,e.$emit("ok"))}))}}}),g=y,w=Object(c["a"])(g,f,v,!1,null,null,null),k=w.exports,x=(a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("bc3a")),q=a.n(x),O=a("5f87"),_={xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"},P="http://localhost:18858";function C(e,t){var a=P+e;q()({method:"get",url:a,responseType:"blob",headers:{Authorization:Object(O["a"])()}}).then((function(e){console.log(e),T(e,_.zip)}))}function T(e,t){var a=document.createElement("a"),n=new Blob([e.data],{type:t}),l=new RegExp("filename=([^;]+\\.[^\\.;]+);*"),i=decodeURI(e.headers["content-disposition"]),r=l.exec(i),o=r[1];o=o.replace(/\"/g,""),a.href=URL.createObjectURL(n),a.setAttribute("download",o),document.body.appendChild(a),a.click(),document.body.appendChild(a)}var L={name:"Gen",components:{importTable:k},data:function(){return{loading:!0,uniqueId:"",ids:[],tableNames:[],single:!0,multiple:!0,total:0,tableList:[],dateRange:"",queryParams:{current:1,size:10,tableName:void 0,tableComment:void 0,datasourceId:void 0},preview:{open:!1,title:"代码预览",data:{},activeName:"entity.java"}}},created:function(){this.getList()},activated:function(){var e=this.$route.query.t;null!==e&&e!==this.uniqueId&&(this.uniqueId=e,this.resetQuery())},methods:{getList:function(){var e=this;this.loading=!0,Object(h["e"])(this.addDateRange(this.queryParams,this.dateRange)).then((function(t){t.success&&(e.tableList=t.data.records,e.total=t.data.total),e.loading=!1}))},handleQuery:function(){this.queryParams.current=1,this.getList()},handleGenTable:function(e){var t=e.tableName||this.tableNames;""!==t?C("/tool/gen/batchGenCode?tables="+t,"ruoyi"):this.msgError("请选择要生成的数据")},openImportTable:function(){this.$refs.import.datasourceId=this.queryParams.datasourceId,this.$refs.import.queryParams.datasourceId=this.queryParams.datasourceId,this.$refs.import.init()},resetQuery:function(){this.dateRange=[],this.resetForm("queryForm"),this.handleQuery()},handlePreview:function(e){var t=this;Object(h["f"])(e.id).then((function(e){t.preview.data=e.data,console.log(e.data),t.preview.open=!0}))},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.tableId})),this.tableNames=e.map((function(e){return e.tableName})),this.single=1!==e.length,this.multiple=!e.length},handleEditTable:function(e){var t=e.id||this.ids[0];this.$router.push({name:"GenEdit",params:{tableId:t}})},handleDelete:function(e){var t=this,a=e.id||this.ids;this.$confirm('是否确认删除表编号为"'+a+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(h["a"])(a)})).then((function(){t.getList(),t.msgSuccess("删除成功")})).catch((function(){}))}}},j=L,I=Object(c["a"])(j,b,p,!1,null,null,null),$=I.exports,N={components:{datasourceList:d,dataTable:$},filters:{statusFilter:function(e){var t={published:"success",draft:"info",deleted:"danger"};return t[e]}},data:function(){return{listLoading:!1,btnLoading:!1,listQuery:{},listData:{roleId:void 0},menuIds:[],treeData:[{label:"aaa",key:1},{label:"aaa",key:2},{label:"aaa",key:3}]}},created:function(){this.initList()},methods:{initList:function(){var e=this;Object(m["c"])().then((function(t){if(t.success){var a=[];t.data.length>0&&(t.data.forEach((function(e){var t={label:e.name,key:e.id};a.push(t)})),e.treeData=a)}}))},handleSelect:function(e){this.$refs.dataTable.queryParams.datasourceId=e.key,this.$refs.dataTable.getList()},refresh:function(){this.btnLoading=!1}}},z=N,S=Object(c["a"])(z,n,l,!1,null,null,null);t["default"]=S.exports},c4fc:function(e,t,a){"use strict";a("6bb1")}}]);